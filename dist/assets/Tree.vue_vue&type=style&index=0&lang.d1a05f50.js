var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,s=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,r=(e,t)=>{for(var a in t||(t={}))n.call(t,a)&&s(e,a,t[a]);if(l)for(var a of l(t))c.call(t,a)&&s(e,a,t[a]);return e},o=(e,l)=>t(e,a(l)),d=(e,t,a)=>new Promise(((l,n)=>{var c=e=>{try{r(a.next(e))}catch(t){n(t)}},s=e=>{try{r(a.throw(e))}catch(t){n(t)}},r=e=>e.done?l(e.value):Promise.resolve(e.value).then(c,s);r((a=a.apply(e,t)).next())}));import{a2 as i,k as u,av as y,aw as h,ae as p,f,G as k,l as v,n as K,L as b,o as L,q as A,S as C,Y as g,Z as x,x as _,s as S,at as m,W as E,ai as T,y as N,u as I,an as D,B as w,r as M,t as j,aM as B,a6 as O,J as P,F as U,bn as R,w as H,v as Y,bW as X,O as $,ah as F,bo as W}from"./vendor.c2cc062a.js";import{j as q,n as z,am as G,p as J,d as Z,aR as Q,c as V,i as ee,aC as te,N as ae,aS as le,ac as ne,A as ce}from"./index.14da3ba2.js";import{u as se}from"./useContextMenu.dcaabdcb.js";import{u as re}from"./useExpose.9766eb76.js";const oe=({icon:e})=>e?q(e)?i(z,{icon:e,class:"mr-1"}):z:null;var de,ie;(ie=de||(de={}))[ie.SELECT_ALL=0]="SELECT_ALL",ie[ie.UN_SELECT_ALL=1]="UN_SELECT_ALL",ie[ie.EXPAND_ALL=2]="EXPAND_ALL",ie[ie.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",ie[ie.CHECK_STRICTLY=4]="CHECK_STRICTLY",ie[ie.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY";var ue=u({name:"BasicTreeHeader",components:{BasicTitle:G,Icon:z,Dropdown:y,Menu:h,MenuItem:h.Item,MenuDivider:h.Divider,InputSearch:p.Search},props:{helpMessage:{type:[String,Array],default:""},title:J.string,toolbar:J.bool,checkable:J.bool,search:J.bool,checkAll:J.func,expandAll:J.func},emits:["strictly-change","search"],setup(e,{emit:t}){const{t:a}=Z(),l=f((()=>{const{checkable:t}=e,l=[{label:a("component.tree.expandAll"),value:de.EXPAND_ALL},{label:a("component.tree.unExpandAll"),value:de.UN_EXPAND_ALL,divider:t}];return t?[{label:a("component.tree.selectAll"),value:de.SELECT_ALL},{label:a("component.tree.unSelectAll"),value:de.UN_SELECT_ALL,divider:t},...l,{label:a("component.tree.checkStrictly"),value:de.CHECK_STRICTLY},{label:a("component.tree.checkUnStrictly"),value:de.CHECK_UN_STRICTLY}]:l}));const n=k((function(e){t("search",e)}),200);return{t:a,toolbarList:l,handleMenuClick:function(a){var l,n,c,s;const{key:r}=a;switch(r){case de.SELECT_ALL:null==(l=e.checkAll)||l.call(e,!0);break;case de.UN_SELECT_ALL:null==(n=e.checkAll)||n.call(e,!1);break;case de.EXPAND_ALL:null==(c=e.expandAll)||c.call(e,!0);break;case de.UN_EXPAND_ALL:null==(s=e.expandAll)||s.call(e,!1);break;case de.CHECK_STRICTLY:t("strictly-change",!1);break;case de.CHECK_UN_STRICTLY:t("strictly-change",!0)}},handleSearch:function(e){n(e.target.value)}}}});const ye=N();v("data-v-db20e602");const he={class:"flex px-2 py-1.5 items-center basic-tree-header"},pe={key:2,class:"flex flex-1 justify-end items-center cursor-pointer"},fe={key:0,class:"mr-1 w-2/3"};K();const ke=ye(((e,t,a,l,n,c)=>{const s=b("BasicTitle"),r=b("InputSearch"),o=b("Icon"),d=b("MenuItem"),i=b("MenuDivider"),u=b("Menu"),y=b("Dropdown");return L(),A("div",he,[e.$slots.headerTitle?C(e.$slots,"headerTitle",{key:0},void 0,!0):g("",!0),!e.$slots.headerTitle&&e.title?(L(),A(s,{key:1,helpMessage:e.helpMessage},{default:ye((()=>[x(_(e.title),1)])),_:1},8,["helpMessage"])):g("",!0),e.search||e.toolbar?(L(),A("div",pe,[e.search?(L(),A("div",fe,[S(r,{placeholder:e.t("common.searchText"),size:"small",allowClear:"",onChange:e.handleSearch},null,8,["placeholder","onChange"])])):g("",!0),e.toolbar?(L(),A(y,{key:1,onClick:t[1]||(t[1]=m((()=>{}),["prevent"]))},{overlay:ye((()=>[S(u,{onClick:e.handleMenuClick},{default:ye((()=>[(L(!0),A(E,null,T(e.toolbarList,(e=>(L(),A(E,{key:e.value},[S(d,{key:e.value},{default:ye((()=>[x(_(e.label),1)])),_:2},1040),e.divider?(L(),A(i,{key:0})):g("",!0)],64)))),128))])),_:1},8,["onClick"])])),default:ye((()=>[S(o,{icon:"ion:ellipsis-vertical"})])),_:1})):g("",!0)])):g("",!0)])}));ue.render=ke,ue.__scopeId="data-v-db20e602";var ve=u({name:"BasicTree",inheritAttrs:!1,props:{value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:J.string,toolbar:J.bool,search:J.bool,checkStrictly:J.bool,clickRowToExpand:J.bool.def(!0),checkable:J.bool.def(!1),defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:J.bool.def(!1),replaceFields:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:null},rightMenuList:{type:Array}},emits:["update:expandedKeys","update:selectedKeys","update:value","change","check"],setup(e,{attrs:t,slots:a,emit:l}){const n=w({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),c=w({startSearch:!1,searchData:[]}),s=M([]),[i]=se(),{prefixCls:u}=V("basic-tree"),y=f((()=>{const{replaceFields:t}=e;return r({children:"children",title:"title",key:"key"},t)})),h=f((()=>{let a=o(r(r({blockNode:!0},t),e),{expandedKeys:n.expandedKeys,selectedKeys:n.selectedKeys,checkedKeys:n.checkedKeys,checkStrictly:n.checkStrictly,replaceFields:I(y),"onUpdate:expandedKeys":e=>{n.expandedKeys=e,l("update:expandedKeys",e)},"onUpdate:selectedKeys":e=>{n.selectedKeys=e,l("update:selectedKeys",e)},onCheck:(e,t)=>{n.checkedKeys=e;const a=j(e);l("update:value",a),l("check",a,t)},onRightClick:C});return a=B(a,"treeData","class"),a})),p=f((()=>c.startSearch?c.searchData:I(s))),k=f((()=>{var e;return c.startSearch&&0===(null==(e=c.searchData)?void 0:e.length)})),{deleteNodeByKey:v,insertNodeByKey:K,filterByLevel:b,updateNodeByKey:L,getAllKeys:A}=function(e,t){return{deleteNodeByKey:function a(l,n){if(!l)return;const c=n||I(e),{key:s,children:r}=I(t);if(r&&s)for(let e=0;e<c.length;e++){const t=c[e],n=t[r];if(t[s]===l){c.splice(e,1);break}n&&n.length&&a(l,t[r])}},insertNodeByKey:function({parentKey:a=null,node:l,push:n="push"}){const c=D(I(e));if(!a)return c[n](l),void(e.value=c);const{key:s,children:r}=I(t);r&&s&&(Q(c,(e=>{e[s]===a&&(e[r]=e[r]||[],e[r][n](l))})),e.value=c)},filterByLevel:function a(l=1,n,c=1){if(!l)return[];const s=[],r=n||I(e)||[];for(let e=0;e<r.length;e++){const n=r[e],{key:o,children:d}=I(t),i=o?n[o]:"",u=d?n[d]:[];s.push(i),u&&u.length&&c<l&&(c+=1,s.push(...a(l,u,c)))}return s},updateNodeByKey:function a(l,n,c){if(!l)return;const s=c||I(e),{key:o,children:d}=I(t);if(d&&o)for(let e=0;e<s.length;e++){const t=s[e],c=t[d];if(t[o]===l){s[e]=r(r({},s[e]),n);break}c&&c.length&&a(l,n,t[d])}},getAllKeys:function a(l){const n=[],c=l||I(e),{key:s,children:r}=I(t);if(!r||!s)return n;for(let e=0;e<c.length;e++){const t=c[e];n.push(t[s]);const l=t[r];l&&l.length&&n.push(...a(l))}return n}}}(s,y);function C(t){return d(this,arguments,(function*({event:t,node:a}){var l;const{rightMenuList:n=[],beforeRightClick:c}=e;let s={event:t,items:[]};if(c&&ee(c)){let e=yield c(a,t);Array.isArray(e)?s.items=e:Object.assign(s,e)}else s.items=n;(null==(l=s.items)?void 0:l.length)&&i(s)}))}function g(e){n.expandedKeys=e}function x(e){n.checkedKeys=e?A():[]}function _(e){n.expandedKeys=e?A():[]}function m(e){n.checkStrictly=e}function T(e){if(!e)return void(c.startSearch=!1);c.startSearch=!0;const{title:t}=I(y);c.searchData=le(I(s),(a=>{var l,n;return null!=(n=null==(l=a[t])?void 0:l.includes(e))&&n}),I(y))}function N(t,a){if(e.clickRowToExpand&&a&&0!==a.length)if(n.expandedKeys.includes(t)){const e=[...n.expandedKeys],a=e.findIndex((e=>e===t));-1!==a&&e.splice(a,1),g(e)}else g([...n.expandedKeys,t])}O((()=>{s.value=e.treeData})),P((()=>{const t=parseInt(e.defaultExpandLevel);t>0?n.expandedKeys=b(t):e.defaultExpandAll&&_(!0)})),O((()=>{n.expandedKeys=e.expandedKeys})),O((()=>{n.selectedKeys=e.selectedKeys})),O((()=>{n.checkedKeys=e.checkedKeys})),U((()=>e.value),(()=>{n.checkedKeys=j(e.value||[])})),U((()=>n.checkedKeys),(()=>{const e=j(n.checkedKeys);l("update:value",e),l("change",e)})),O((()=>{n.checkStrictly=e.checkStrictly}));function q(t){const{actionList:a}=e;if(a&&0!==a.length)return a.map(((e,a)=>{var l;let n=!0;return ee(e.show)?n=null==(l=e.show)?void 0:l.call(e,t):ce(e.show)&&(n=e.show),n?S("span",{key:a,class:`${u}__action`},[e.render(t)]):null}))}function z({data:t,level:l}){return t?t.map((t=>{const{title:n,key:c,children:s}=I(y),d=B(t,"title"),i=function(t,a){return!a&&e.renderIcon&&ee(e.renderIcon)?e.renderIcon(t):a}(o(r({},t),{level:l}),t.icon),p=W(t,s)||[];return S(X.TreeNode,$(d,{node:j(t),key:W(t,c)}),{title:()=>{var e;return S("span",{class:`${u}-title pl-2`,onClick:N.bind(null,t[c],t[s])},[(null==a?void 0:a.title)?ne(a,"title",t):S(E,null,[i&&S(oe,{icon:i},null),S("span",{class:(null==(e=I(h))?void 0:e.blockNode)?`${u}__content`:""},[W(t,n)]),S("span",{class:`${u}__actions`},[q(o(r({},t),{level:l}))])])])},default:()=>z({data:p,level:l+1})})})):null}return re({setExpandedKeys:g,getExpandedKeys:function(){return n.expandedKeys},setSelectedKeys:function(e){n.selectedKeys=e},getSelectedKeys:function(){return n.selectedKeys},setCheckedKeys:function(e){n.checkedKeys=e},getCheckedKeys:function(){return n.checkedKeys},insertNodeByKey:K,deleteNodeByKey:v,updateNodeByKey:L,checkAll:x,expandAll:_,filterByLevel:e=>{n.expandedKeys=b(e)}}),()=>{let l;const{title:n,helpMessage:c,toolbar:s,search:o,checkable:d}=e,i=n||s||o||a.headerTitle;return S("div",{class:[u,"h-full",t.class]},[i&&S(ue,{checkable:d,checkAll:x,expandAll:_,title:n,search:o,toolbar:s,helpMessage:c,onStrictlyChange:m,onSearch:T},(y=l=te(a),"function"==typeof y||"[object Object]"===Object.prototype.toString.call(y)&&!R(y)?l:{default:()=>[l]})),H(S(ae,{style:{height:"calc(100% - 38px)"}},{default:()=>[S(X,$(I(h),{showIcon:!1}),r({default:()=>z({data:I(p),level:1})},te(a)))]}),[[Y,!I(k)]]),H(S(F,{class:"!mt-4"},null),[[Y,I(k)]])]);var y}}});export{ve as _};
