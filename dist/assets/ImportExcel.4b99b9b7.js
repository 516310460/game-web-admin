var e=(e,t,n)=>new Promise(((r,s)=>{var a=e=>{try{o(n.next(e))}catch(t){s(t)}},l=e=>{try{o(n.throw(e))}catch(t){s(t)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(a,l);o((n=n.apply(e,t)).next())}));import{X as t}from"./index.bac904f6.js";import{k as n,r,u as s,o as a,q as l,w as o,v as c,s as u,S as i}from"./vendor.c2cc062a.js";import"./index.a031c7d6.js";import"./createAsyncComponent.fe509f95.js";var f=n({name:"ImportExcel",emits:["success","error"],setup(n,{emit:a}){const l=r(null),o=r(!1);function c(e){if(!e||!e["!ref"])return[];const n=[],r=t.utils.decode_range(e["!ref"]),s=r.s.r;for(let a=r.s.c;a<=r.e.c;++a){const r=e[t.utils.encode_cell({c:a,r:s})];let l="UNKNOWN "+a;r&&r.t&&(l=t.utils.format_cell(r)),n.push(l)}return n}function u(n){return o.value=!0,new Promise(((r,s)=>{const l=new FileReader;l.onload=n=>e(this,null,(function*(){try{const e=n.target&&n.target.result,s=function(e){const n=[];for(const r of e.SheetNames){const s=e.Sheets[r],a=c(s),l=t.utils.sheet_to_json(s);n.push({header:a,results:l,meta:{sheetName:r}})}return n}(t.read(e,{type:"array"}));a("success",s),r("")}catch(e){s(e),a("error")}finally{o.value=!1}})),l.readAsArrayBuffer(n)}))}return{handleUpload:function(){const e=s(l);e&&e.click()},handleInputClick:function(t){const n=t&&t.target.files,r=n&&n[0];r&&function(t){e(this,null,(function*(){const e=s(l);e&&(e.value=""),yield u(t)}))}(r)},inputRef:l}}});f.render=function(e,t,n,r,s,f){return a(),l("div",null,[o(u("input",{ref:"inputRef",type:"file",accept:".xlsx, .xls",onChange:t[1]||(t[1]=(...t)=>e.handleInputClick&&e.handleInputClick(...t))},null,544),[[c,!1]]),u("div",{onClick:t[2]||(t[2]=(...t)=>e.handleUpload&&e.handleUpload(...t))},[i(e.$slots,"default")])])};export default f;
