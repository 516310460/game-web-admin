var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,n,l)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l;import{p as a,n as c,aT as i}from"./index.e2f8dfb6.js";import{k as u,r as d,f as p,J as m,K as f,a1 as y,u as b,s as v,aX as h,W as x,aw as w,bn as j,aJ as O,a3 as E}from"./vendor.c2cc062a.js";/* empty css              */const I={width:a.number.def(156),customEvent:{type:Object,default:null},styles:a.style,showIcon:a.bool.def(!0),axis:{type:Object,default:()=>({x:0,y:0})},items:{type:Array,default:()=>[]}};const g=e=>{const{item:t}=e;return v("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&v(c,{class:"mr-2",icon:t.icon},null),v("span",null,[t.label])])};var k=u({name:"ContextMenu",props:I,setup(e){const a=d(null),c=d(!1),i=p((()=>{const{axis:a,items:c,styles:i,width:u}=e,{x:d,y:p}=a||{x:0,y:0},m=40*(c||[]).length,f=u,y=document.body,b=y.clientWidth<d+f?d-f:d,v=y.clientHeight<p+m?p-m:p;return h=((e,t)=>{for(var n in t||(t={}))s.call(t,n)&&r(e,n,t[n]);if(l)for(var n of l(t))o.call(t,n)&&r(e,n,t[n]);return e})({},i),t(h,n({width:`${u}px`,left:`${b+1}px`,top:`${v+1}px`}));var h}));function u(e,t){const{handler:n,disabled:l}=e;l||(c.value=!1,null==t||t.stopPropagation(),null==t||t.preventDefault(),null==n||n())}function O(t){return t.map((t=>{const{disabled:n,label:l,children:s,divider:o=!1}=t,r=o?v(h,{key:`d-${l}`},null):null;return s&&0!==s.length?b(c)?v(w.SubMenu,{key:l,disabled:n,popupClassName:"context-menu__popup"},{title:()=>v(g,{showIcon:e.showIcon,item:t,handler:u},null),default:()=>O(s)}):null:v(x,null,[v(w.Item,{disabled:n,class:"context-menu__item",key:l},{default:()=>[v(g,{showIcon:e.showIcon,item:t,handler:u},null)]}),r])}))}return m((()=>{f((()=>c.value=!0))})),y((()=>{const e=b(a);e&&document.body.removeChild(e)})),()=>{let t;const{items:n}=e;return b(c)?v(w,{inlineIndent:12,mode:"vertical",class:"context-menu",ref:a,style:b(i)},"function"==typeof(l=t=O(n))||"[object Object]"===Object.prototype.toString.call(l)&&!j(l)?t:{default:()=>[t]}):null;var l}}});const L={domList:[],resolve:()=>{}},P=function(e){const{event:t}=e||{};if(t&&(null==t||t.preventDefault()),i)return new Promise((n=>{const l=document.body,s=document.createElement("div"),o={};e.styles&&(o.styles=e.styles),e.items&&(o.items=e.items),e.event&&(o.customEvent=t,o.axis={x:t.clientX,y:t.clientY});const r=v(k,o);O(r,s);const a=function(){L.resolve("")};L.domList.push(s);const c=function(){L.domList.forEach((e=>{try{e&&l.removeChild(e)}catch(t){}})),l.removeEventListener("click",a),l.removeEventListener("scroll",a)};L.resolve=function(...e){c(),n(e[0])},c(),l.appendChild(s),l.addEventListener("click",a),l.addEventListener("scroll",a)}))},C=function(){L&&(L.resolve(""),L.domList=[])};function $(e=!0){return E()&&e&&y((()=>{C()})),[P,C]}export{$ as u};
