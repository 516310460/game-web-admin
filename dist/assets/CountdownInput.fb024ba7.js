import{B as t,C as n,a6 as e,f as a,a3 as u,b2 as o,r as s,u as r,$ as l,k as c,aK as i,L as d,o as f,q as v,O as p,R as m,Z as C,x as S,ae as b,s as x}from"./vendor.c2cc062a.js";import{p as h,d as y,i as g,c as w}from"./index.7fd854bf.js";function z(s,r="value",l="change"){const c=u(),i=null==c?void 0:c.emit,d=t({value:s[r]}),f=n(d);e((()=>{d.value=s[r]}));return[a({get:()=>d.value,set(t){o(t,f.value)||(d.value=t,null==i||i(l,t))}}),t=>{d.value=t},f]}var B=c({name:"CountButton",components:{Button:i},props:{value:h.any,count:h.number.def(60),beforeStartFunc:{type:Function,default:null}},setup(t){const n=s(!1),{currentCount:a,isStart:u,start:o,reset:c}=function(t){const n=s(t),e=s(!1);let a;function u(){a&&window.clearInterval(a)}function o(){e.value=!1,u(),a=null}function c(){r(e)||a||(e.value=!0,a=setInterval((()=>{1===r(n)?(o(),n.value=t):n.value-=1}),1e3))}function i(){n.value=t,o()}return l((()=>{i()})),{start:c,reset:i,restart:function(){i(),c()},clear:u,stop:o,currentCount:n,isStart:e}}(t.count),{t:i}=y();return e((()=>{void 0===t.value&&c()})),{handleStart:function(){return e=this,a=null,u=function*(){const{beforeStartFunc:e}=t;if(e&&g(e)){n.value=!0;try{(yield e())&&o()}finally{n.value=!1}}else o()},new Promise(((t,n)=>{var o=t=>{try{r(u.next(t))}catch(e){n(e)}},s=t=>{try{r(u.throw(t))}catch(e){n(e)}},r=n=>n.done?t(n.value):Promise.resolve(n.value).then(o,s);r((u=u.apply(e,a)).next())}));var e,a,u},isStart:u,currentCount:a,loading:n,t:i}}});B.render=function(t,n,e,a,u,o){const s=d("Button");return f(),v(s,p(t.$attrs,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading}),{default:m((()=>[C(S(t.isStart?t.t("component.countdown.sendText",[t.currentCount]):t.t("component.countdown.normalText")),1)])),_:1},16,["disabled","onClick","loading"])};var F=c({name:"CountDownInput",components:{[b.name]:b,CountButton:B},inheritAttrs:!1,props:{value:h.string,size:h.oneOf(["default","large","small"]),count:h.number.def(60),sendCodeApi:{type:Function,default:null}},setup(t){const{prefixCls:n}=w("countdown-input"),[e]=z(t);return{prefixCls:n,state:e}}});F.render=function(t,n,e,a,u,o){const s=d("CountButton"),r=d("AInput");return f(),v(r,p(t.$attrs,{class:t.prefixCls,size:t.size,value:t.state}),{addonAfter:m((()=>[x(s,{size:t.size,count:t.count,value:t.state,beforeStartFunc:t.sendCodeApi},null,8,["size","count","value","beforeStartFunc"])])),_:1},16,["class","size","value"])};export{F as _,z as u};
